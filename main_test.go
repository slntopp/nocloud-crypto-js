/*
Copyright Â© 2021-2022 Nikita Ivanovski info@slnt-opp.xyz

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/
package main

import (
	"testing"
)

func Test_sha256HashCertificate(t *testing.T) {
	data := []byte{45, 45, 45, 45, 45, 66, 69, 71, 73, 78, 32, 67, 69, 82, 84, 73, 70, 73, 67, 65, 84, 69, 45, 45, 45, 45, 45, 10, 77, 73, 73, 70, 70, 84, 67, 67, 65, 118, 50, 103, 65, 119, 73, 66, 65, 103, 73, 85, 71, 107, 103, 117, 57, 121, 117, 75, 113, 85, 79, 90, 79, 121, 100, 71, 65, 89, 76, 108, 118, 118, 43, 65, 116, 117, 73, 119, 68, 81, 89, 74, 75, 111, 90, 73, 104, 118, 99, 78, 65, 81, 69, 76, 10, 66, 81, 65, 119, 71, 106, 69, 89, 77, 66, 89, 71, 65, 49, 85, 69, 65, 119, 119, 80, 101, 109, 86, 121, 98, 121, 53, 106, 98, 71, 108, 108, 98, 110, 81, 117, 98, 109, 86, 48, 77, 66, 52, 88, 68, 84, 73, 120, 77, 84, 73, 119, 79, 84, 65, 51, 77, 122, 103, 122, 78, 86, 111, 88, 10, 68, 84, 73, 121, 77, 68, 69, 119, 79, 68, 65, 51, 77, 122, 103, 122, 78, 86, 111, 119, 71, 106, 69, 89, 77, 66, 89, 71, 65, 49, 85, 69, 65, 119, 119, 80, 101, 109, 86, 121, 98, 121, 53, 106, 98, 71, 108, 108, 98, 110, 81, 117, 98, 109, 86, 48, 77, 73, 73, 67, 73, 106, 65, 78, 10, 66, 103, 107, 113, 104, 107, 105, 71, 57, 119, 48, 66, 65, 81, 69, 70, 65, 65, 79, 67, 65, 103, 56, 65, 77, 73, 73, 67, 67, 103, 75, 67, 65, 103, 69, 65, 117, 121, 77, 116, 104, 53, 84, 103, 66, 108, 67, 100, 86, 55, 77, 87, 57, 80, 52, 67, 116, 90, 67, 122, 88, 54, 73, 116, 10, 86, 52, 84, 75, 54, 76, 71, 107, 117, 122, 69, 102, 85, 111, 99, 65, 117, 78, 83, 72, 120, 106, 101, 116, 78, 117, 115, 78, 80, 81, 51, 118, 67, 50, 87, 117, 85, 103, 53, 85, 51, 79, 122, 73, 98, 73, 111, 108, 87, 97, 116, 122, 87, 109, 47, 115, 117, 53, 90, 43, 88, 118, 82, 66, 10, 105, 49, 69, 49, 99, 110, 51, 72, 90, 119, 69, 101, 115, 52, 51, 66, 74, 56, 109, 120, 78, 82, 98, 97, 47, 87, 83, 82, 103, 84, 66, 100, 121, 67, 112, 100, 77, 119, 109, 119, 110, 80, 88, 122, 65, 67, 88, 79, 101, 81, 119, 49, 52, 73, 101, 89, 103, 72, 100, 80, 104, 51, 112, 105, 10, 104, 79, 72, 76, 66, 121, 100, 122, 57, 54, 70, 80, 113, 118, 67, 47, 103, 89, 103, 51, 102, 55, 105, 108, 88, 103, 114, 72, 43, 89, 48, 75, 80, 67, 88, 55, 51, 49, 116, 75, 90, 66, 65, 83, 81, 99, 88, 51, 100, 106, 100, 48, 65, 82, 101, 84, 101, 66, 111, 50, 104, 84, 82, 74, 10, 67, 76, 98, 111, 109, 75, 111, 74, 51, 89, 70, 115, 90, 72, 54, 57, 104, 55, 103, 104, 107, 56, 120, 79, 102, 86, 54, 52, 49, 122, 86, 87, 73, 50, 82, 99, 108, 48, 105, 51, 65, 107, 118, 107, 121, 105, 119, 115, 53, 85, 112, 101, 76, 56, 122, 99, 52, 120, 67, 68, 68, 65, 117, 106, 10, 107, 113, 74, 75, 76, 90, 79, 120, 117, 70, 74, 74, 105, 122, 56, 122, 121, 98, 110, 53, 54, 85, 112, 43, 108, 87, 74, 118, 43, 107, 98, 51, 110, 54, 110, 104, 66, 115, 71, 78, 71, 111, 103, 55, 80, 107, 119, 67, 73, 43, 81, 114, 116, 70, 66, 119, 106, 102, 98, 53, 111, 121, 48, 87, 10, 55, 72, 75, 109, 80, 70, 82, 77, 120, 53, 47, 98, 49, 53, 103, 121, 75, 67, 85, 78, 69, 100, 78, 69, 90, 48, 72, 105, 112, 98, 82, 115, 111, 70, 111, 108, 72, 74, 57, 56, 70, 76, 82, 119, 55, 85, 98, 52, 118, 120, 56, 83, 111, 70, 80, 114, 74, 113, 111, 122, 100, 115, 114, 78, 10, 102, 67, 57, 90, 119, 70, 101, 116, 99, 78, 78, 105, 47, 80, 47, 98, 65, 55, 55, 99, 118, 47, 105, 90, 86, 97, 103, 43, 69, 83, 111, 117, 106, 55, 119, 108, 67, 81, 122, 100, 108, 66, 78, 49, 100, 115, 53, 77, 108, 121, 121, 86, 65, 105, 100, 89, 73, 68, 84, 69, 105, 87, 119, 74, 10, 109, 116, 100, 69, 106, 67, 75, 119, 114, 69, 49, 102, 87, 105, 105, 67, 82, 85, 111, 79, 57, 48, 100, 50, 121, 72, 111, 76, 69, 107, 65, 75, 52, 57, 103, 76, 118, 88, 87, 69, 51, 55, 118, 73, 52, 90, 102, 100, 57, 103, 87, 115, 86, 119, 113, 122, 105, 108, 55, 115, 104, 76, 114, 113, 10, 104, 66, 119, 70, 47, 121, 105, 79, 43, 117, 43, 75, 66, 69, 75, 98, 100, 65, 77, 65, 79, 73, 67, 100, 120, 90, 107, 67, 43, 100, 105, 43, 80, 81, 107, 116, 52, 67, 109, 117, 51, 53, 52, 51, 118, 57, 57, 115, 114, 83, 50, 73, 73, 115, 97, 111, 73, 88, 86, 57, 101, 70, 110, 90, 10, 110, 120, 82, 81, 78, 98, 90, 49, 74, 81, 57, 120, 98, 66, 105, 97, 104, 80, 65, 122, 98, 84, 121, 70, 88, 113, 119, 115, 97, 48, 52, 116, 88, 66, 67, 43, 48, 98, 80, 48, 110, 115, 57, 65, 52, 43, 79, 105, 47, 81, 68, 80, 48, 86, 54, 47, 88, 102, 119, 66, 103, 109, 115, 101, 10, 122, 107, 67, 48, 73, 100, 120, 72, 108, 48, 120, 102, 107, 43, 99, 67, 65, 119, 69, 65, 65, 97, 78, 84, 77, 70, 69, 119, 72, 81, 89, 68, 86, 82, 48, 79, 66, 66, 89, 69, 70, 68, 115, 100, 111, 88, 75, 50, 106, 71, 88, 78, 97, 99, 109, 119, 119, 54, 121, 87, 103, 109, 108, 117, 10, 80, 67, 69, 47, 77, 66, 56, 71, 65, 49, 85, 100, 73, 119, 81, 89, 77, 66, 97, 65, 70, 68, 115, 100, 111, 88, 75, 50, 106, 71, 88, 78, 97, 99, 109, 119, 119, 54, 121, 87, 103, 109, 108, 117, 80, 67, 69, 47, 77, 65, 56, 71, 65, 49, 85, 100, 69, 119, 69, 66, 47, 119, 81, 70, 10, 77, 65, 77, 66, 65, 102, 56, 119, 68, 81, 89, 74, 75, 111, 90, 73, 104, 118, 99, 78, 65, 81, 69, 76, 66, 81, 65, 68, 103, 103, 73, 66, 65, 72, 100, 119, 104, 81, 117, 53, 57, 100, 83, 48, 50, 97, 48, 52, 122, 75, 78, 49, 88, 122, 116, 71, 97, 72, 43, 47, 53, 69, 84, 116, 10, 68, 102, 103, 54, 89, 108, 114, 86, 88, 53, 53, 82, 116, 52, 71, 108, 118, 120, 56, 103, 122, 75, 83, 51, 109, 106, 89, 70, 77, 77, 117, 89, 75, 122, 112, 52, 107, 111, 72, 70, 97, 88, 107, 90, 110, 66, 85, 71, 86, 75, 111, 67, 102, 89, 74, 57, 106, 122, 87, 72, 85, 67, 119, 66, 10, 83, 49, 101, 104, 115, 107, 52, 117, 122, 112, 87, 47, 85, 51, 103, 73, 98, 104, 117, 103, 72, 76, 74, 97, 53, 48, 81, 70, 66, 99, 57, 75, 90, 108, 107, 73, 76, 121, 109, 71, 68, 111, 104, 108, 90, 111, 66, 113, 86, 117, 80, 77, 90, 115, 115, 105, 47, 119, 97, 52, 109, 105, 69, 56, 10, 122, 86, 80, 109, 66, 74, 121, 114, 106, 74, 113, 43, 111, 72, 55, 81, 111, 101, 80, 72, 122, 50, 103, 83, 102, 75, 52, 68, 107, 71, 67, 81, 49, 121, 87, 57, 110, 72, 55, 90, 68, 52, 82, 87, 57, 50, 83, 72, 75, 84, 97, 43, 103, 52, 74, 120, 66, 111, 110, 89, 56, 118, 112, 69, 10, 73, 82, 78, 106, 65, 106, 113, 109, 66, 56, 90, 67, 71, 116, 51, 49, 106, 71, 83, 78, 55, 75, 119, 110, 83, 73, 79, 53, 43, 65, 57, 50, 57, 87, 118, 117, 120, 71, 98, 119, 51, 111, 51, 82, 75, 81, 86, 99, 82, 103, 81, 51, 117, 106, 102, 77, 105, 118, 122, 89, 71, 88, 104, 78, 10, 80, 79, 66, 57, 82, 66, 81, 83, 107, 73, 117, 82, 112, 90, 51, 77, 71, 67, 49, 105, 98, 97, 69, 84, 88, 110, 87, 75, 90, 72, 73, 105, 117, 77, 75, 48, 106, 76, 65, 56, 90, 66, 98, 111, 54, 114, 65, 108, 110, 77, 121, 75, 99, 102, 105, 111, 67, 121, 104, 55, 43, 101, 84, 48, 10, 113, 69, 73, 69, 107, 47, 108, 55, 108, 110, 110, 68, 100, 119, 43, 114, 53, 115, 105, 110, 69, 65, 57, 72, 102, 112, 112, 47, 53, 48, 115, 108, 48, 86, 88, 109, 48, 54, 66, 117, 119, 116, 47, 49, 107, 86, 74, 51, 100, 48, 97, 80, 86, 77, 73, 55, 86, 55, 97, 88, 116, 117, 110, 82, 10, 100, 56, 117, 78, 52, 83, 80, 89, 107, 78, 54, 72, 109, 80, 105, 52, 69, 87, 99, 99, 117, 118, 121, 70, 51, 111, 102, 72, 50, 55, 115, 110, 65, 80, 85, 104, 110, 65, 84, 89, 100, 82, 50, 73, 109, 121, 109, 77, 86, 85, 106, 47, 109, 104, 117, 51, 116, 49, 77, 52, 82, 115, 85, 103, 10, 114, 43, 117, 115, 85, 56, 56, 100, 114, 114, 71, 81, 81, 100, 117, 69, 85, 116, 87, 117, 105, 84, 68, 103, 51, 69, 122, 56, 53, 88, 53, 75, 78, 81, 103, 88, 78, 47, 79, 87, 102, 68, 80, 103, 121, 90, 122, 69, 107, 120, 80, 78, 57, 115, 101, 82, 85, 53, 82, 86, 49, 48, 89, 104, 10, 83, 55, 51, 56, 89, 106, 72, 114, 113, 101, 116, 117, 116, 51, 102, 77, 51, 68, 70, 108, 76, 107, 88, 81, 88, 43, 98, 71, 86, 43, 73, 121, 119, 53, 103, 112, 112, 98, 107, 88, 99, 108, 73, 88, 87, 90, 100, 83, 77, 50, 43, 115, 77, 74, 90, 111, 107, 71, 112, 111, 49, 110, 57, 110, 10, 78, 71, 86, 48, 106, 47, 105, 53, 87, 118, 86, 76, 56, 102, 102, 78, 52, 109, 86, 54, 76, 118, 84, 49, 100, 81, 87, 72, 90, 118, 118, 77, 85, 109, 105, 100, 99, 98, 51, 43, 117, 66, 71, 101, 117, 98, 109, 69, 81, 105, 122, 117, 116, 99, 90, 53, 78, 111, 53, 54, 81, 86, 79, 102, 10, 115, 80, 102, 89, 67, 98, 53, 104, 43, 43, 69, 98, 10, 45, 45, 45, 45, 45, 69, 78, 68, 32, 67, 69, 82, 84, 73, 70, 73, 67, 65, 84, 69, 45, 45, 45, 45, 45, 10}
	result, err := sha256HashCertificate(data)
	if err != nil {
		t.Errorf("Unexpected error: %s", err.Error())
	}
	t.Logf("Resulting Hash: %s", result)
	if result != "419d3335b2b533526d4e7f6f1041b3c492d086cad0f5876739800ffd51659545" {
		t.Errorf("Hash incorrect")
	}
}